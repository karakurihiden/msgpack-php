#ifndef MSGPACK_H
#define MSGPACK_H

#ifdef HAVE_SYS_TYPES_H
#include <sys/types.h>
#endif

#ifdef HAVE_STDINT_H
#include <stdint.h>
#endif

#ifdef HAVE_INTTYPES_H
#include <inttypes.h>
#endif
#if PHP_WIN32
# include "win32/php_stdint.h"
#endif

#if HAVE_ARPA_INET_H
#include <arpa/inet.h>
#endif

#ifndef WORDS_BIGENDIAN
/* LETTLEENDIAN */

/* msgpack_be16 */
#ifdef PHP_WIN32
#  if defined(ntohs)
#    define msgpack_be16(x) ntohs(x)
#  elif defined(_byteswap_ushort) || (defined(_MSC_VER) && _MSC_VER >= 1400)
#    define msgpack_be16(x) ((uint16_t)_byteswap_ushort((unsigned short)x))
#  else
#    define msgpack_be16(x) (      \
        ((((uint16_t)x) <<  8) ) | \
        ((((uint16_t)x) >>  8) ) )
#  endif
#else
#  define msgpack_be16(x) ntohs(x)
#endif

/* msgpack_be32 */
#ifdef PHP_WIN32
#  if defined(ntohl)
#    define msgpack_be32(x) ntohl(x)
#  elif defined(_byteswap_ulong) || (defined(_MSC_VER) && _MSC_VER >= 1400)
#    define msgpack_be32(x) ((uint32_t)_byteswap_ulong((unsigned long)x))
#  else
#    define msgpack_be32(x)                        \
        ( ((((uint32_t)x) << 24)               ) | \
          ((((uint32_t)x) <<  8) & 0x00ff0000U ) | \
          ((((uint32_t)x) >>  8) & 0x0000ff00U ) | \
          ((((uint32_t)x) >> 24)               ) )
#  endif
#else
#  define msgpack_be32(x) ntohl(x)
#endif

/* msgpack_be64 */
#if defined(_byteswap_uint64) || (defined(_MSC_VER) && _MSC_VER >= 1400)
#  define msgpack_be64(x) (_byteswap_uint64(x))
#elif defined(bswap_64)
#  define msgpack_be64(x) bswap_64(x)
#elif defined(__DARWIN_OSSwapInt64)
#  define msgpack_be64(x) __DARWIN_OSSwapInt64(x)
#else
#define msgpack_be64(x)                                  \
    ( ((((uint64_t)x) << 56)                         ) | \
      ((((uint64_t)x) << 40) & 0x00ff000000000000ULL ) | \
      ((((uint64_t)x) << 24) & 0x0000ff0000000000ULL ) | \
      ((((uint64_t)x) <<  8) & 0x000000ff00000000ULL ) | \
      ((((uint64_t)x) >>  8) & 0x00000000ff000000ULL ) | \
      ((((uint64_t)x) >> 24) & 0x0000000000ff0000ULL ) | \
      ((((uint64_t)x) >> 40) & 0x000000000000ff00ULL ) | \
      ((((uint64_t)x) >> 56)                         ) )
#endif

#else
/* BIGENDIAN */
#define msgpack_be16(x) (x)
#define msgpack_be32(x) (x)
#define msgpack_be64(x) (x)

#endif

#endif /* MSGPACK_H */
